---
import Button from '../../components/ui/Button.astro'

interface Props {
  productID: string
  inStockCount: number
}

const { productID, inStockCount } = Astro.props
---

<div
  x-data={`{ productID: '${productID}', inStockCount: ${inStockCount} }`}
>
  <template x-if="inStockCount > 0">
    <div class="-mt-1.5 -mr-2">
      <template x-if="! $store.cart.isProductInCart($data)">
        <div class="flex justify-end">
          <Button
            title="Добавить в корзину"
            variant="iconLink"
            onClick="$store.cart.addOne($data)"
          >
            <svg class="w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true">
              <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 256v128M320 320H192M80 176a16 16 0 00-16 16v216c0 30.24 25.76 56 56 56h272c30.24 0 56-24.51 56-54.75V192a16 16 0 00-16-16zM160 176v-32a96 96 0 0196-96h0a96 96 0 0196 96v32"/>
            </svg>
          </Button>
        </div>
      </template>
    
      <template x-if="$store.cart.isProductInCart($data)">
        <div class="flex justify-between items-center">
          <p class="text-sm font-semibold mr-4" x-text="$store.cart.currentProduct($data).quantity + ' шт.'" />

          <div class="flex items-center">
            <template x-if="$store.cart.currentProduct($data).quantity === 1">
              <Button
                title="Удалить"
                variant="iconLink"
                extraClasses="text-red"
                onClick="$store.cart.removeOne($data)"
              >
                <svg class="w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true">
                  <path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M320 320L192 192M192 320l128-128"/>
                </svg>
              </Button>
            </template>
        
            <template x-if="$store.cart.currentProduct($data).quantity > 1">
              <Button
                title="Убрать"
                variant="iconLink"
                onClick="$store.cart.removeOne($data)"
              >
                <svg class="w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true">
                  <path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M336 256H176"/>
                </svg>
              </Button>
            </template>

            <template x-if="$store.cart.isSoldOut($data)">
              <Button
                title="Больше нет в наличии"
                variant="iconLink"
                extraClasses="text-yellow"
                disabled
                onClick="$store.cart.removeOne($data)"
              >
                <svg class="w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true">
                  <path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
                  <path d="M250.26 166.05L256 288l5.73-121.95a5.74 5.74 0 00-5.79-6h0a5.74 5.74 0 00-5.68 6z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                  <path d="M256 367.91a20 20 0 1120-20 20 20 0 01-20 20z" fill="currentColor"/>
                </svg>
              </Button>
            </template>

            <template x-if="! $store.cart.isSoldOut($data)">
              <Button
                title="Добавить еще"
                variant="iconLink"
                onClick="$store.cart.addOne($data)"
              >
                <svg class="w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" aria-hidden="true">
                  <path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v160M336 256H176"/>
                </svg>
              </Button>
            </template>
          </div>
        </div>
      </template>
    </div>
  </template>

  <template x-if="inStockCount <= 0">
    <p class="mt-1 text-sm text-gray">
      Товар закончился
    </p>
  </template>
</div>
